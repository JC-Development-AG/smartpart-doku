<?xml version="1.0" encoding="UTF-8"?><ScriptObject><Version>1.0</Version>
<ScriptVersion>1.0</ScriptVersion>
<Name><![CDATA[Curved3DText]]></Name>
<LibPath><![CDATA[]]></LibPath>
<Type>1</Type>
<SubType>0</SubType>
<UUID>edf885d0-0aa7-47ab-8aa4-306a35746fe0</UUID>
<Language>de</Language>
<StringTable>
</StringTable>
<RelativeOrigin>0.5000000000000000 0.5000000000000000 0.5000000000000000</RelativeOrigin>
<AbsoluteOrigin>0.0000000000000000 0.0000000000000000 0.0000000000000000</AbsoluteOrigin>
<SeparateExecParts>1</SeparateExecParts>
<Group>0</Group>
<AutoPlaceResourceObjects>1</AutoPlaceResourceObjects>
<AutoReferenceBox>1</AutoReferenceBox>
<Scale>1</Scale>
<Use3DPreview>0</Use3DPreview>
<Link>0</Link>
<Consider>0</Consider>
<SimplePlacing>0</SimplePlacing>
<HeightReference>0</HeightReference>
<HeightOffset>0.0000000000000000</HeightOffset>
<UnitFactor>1.0000000000000000</UnitFactor>
<PositionNumber>1</PositionNumber>
<IsLocked>0</IsLocked>
<IsEncrypted>0</IsEncrypted>
<Key><![CDATA[]]></Key>
<DependentFiles>
</DependentFiles>
<Parameters>
<Type>1</Type>
<AutoUpdateValues>1</AutoUpdateValues>
<MapPenToColor>0</MapPenToColor>
<Parameter>
<Identifier>bezier_points</Identifier>
<Name><![CDATA[Bezierkurve]]></Name>
<Group><![CDATA[]]></Group>
<Type>1</Type>
<Attribute>-1</Attribute>
<SystemID>0</SystemID>
<Expandable>0</Expandable>
<Hidden>0</Hidden>
<Lock>0</Lock>
<Export>0</Export>
<Save>1</Save>
<CurrentValue>
<Value>
<Type>6</Type>
<StringValue/>
<DoubleValue>0.000000000000</DoubleValue>
</Value>
</CurrentValue>
<ValueArray>
<Dimension>2</Dimension>
<Bounds>
<Bound Expandable="0">4</Bound>
<Bound Expandable="0">2</Bound>
<Bound Expandable="0">0</Bound>
<Bound Expandable="0">0</Bound>
<Bound Expandable="0">0</Bound>
<Bound Expandable="0">0</Bound>
<Bound Expandable="0">0</Bound>
<Bound Expandable="0">0</Bound>
<Bound Expandable="0">0</Bound>
<Bound Expandable="0">0</Bound>
</Bounds>
<Values>
<Value>
<Type>6</Type>
<StringValue/>
<DoubleValue>-0.764944840063</DoubleValue>
</Value>
<Value>
<Type>6</Type>
<StringValue/>
<DoubleValue>-0.652321208987</DoubleValue>
</Value>
<Value>
<Type>6</Type>
<StringValue/>
<DoubleValue>4.974213736590</DoubleValue>
</Value>
<Value>
<Type>6</Type>
<StringValue/>
<DoubleValue>5.164903320174</DoubleValue>
</Value>
<Value>
<Type>6</Type>
<StringValue/>
<DoubleValue>2.436490972052</DoubleValue>
</Value>
<Value>
<Type>6</Type>
<StringValue/>
<DoubleValue>-1.397446156571</DoubleValue>
</Value>
<Value>
<Type>6</Type>
<StringValue/>
<DoubleValue>2.541599937123</DoubleValue>
</Value>
<Value>
<Type>6</Type>
<StringValue/>
<DoubleValue>-1.545165987219</DoubleValue>
</Value>
</Values>
</ValueArray>
</Parameter>
<Parameter>
<Identifier>char_width_factor</Identifier>
<Name><![CDATA[Zeichenbreitefaktor]]></Name>
<Group><![CDATA[]]></Group>
<Type>6</Type>
<Attribute>-1</Attribute>
<SystemID>0</SystemID>
<Expandable>0</Expandable>
<Hidden>0</Hidden>
<Lock>0</Lock>
<Export>0</Export>
<Save>1</Save>
<CurrentValue>
<Value>
<Type>6</Type>
<StringValue/>
<DoubleValue>1.000000000000</DoubleValue>
</Value>
</CurrentValue>
</Parameter>
<Parameter>
<Identifier>curved_text</Identifier>
<Name><![CDATA[Text]]></Name>
<Group><![CDATA[]]></Group>
<Type>3</Type>
<Attribute>-1</Attribute>
<SystemID>0</SystemID>
<Expandable>0</Expandable>
<Hidden>0</Hidden>
<Lock>0</Lock>
<Export>0</Export>
<Save>1</Save>
<CurrentValue>
<Value>
<Type>3</Type>
<StringValue><![CDATA[Text on a Bezier Curve]]></StringValue>
<DoubleValue>0.000000000000</DoubleValue>
</Value>
</CurrentValue>
</Parameter>
<Parameter>
<Identifier>font_name</Identifier>
<Name><![CDATA[Fontname]]></Name>
<Group><![CDATA[]]></Group>
<Type>3</Type>
<Attribute>-1</Attribute>
<SystemID>0</SystemID>
<Expandable>0</Expandable>
<Hidden>0</Hidden>
<Lock>0</Lock>
<Export>0</Export>
<Save>1</Save>
<CurrentValue>
<Value>
<Type>3</Type>
<StringValue><![CDATA[Arial]]></StringValue>
<DoubleValue>0.000000000000</DoubleValue>
</Value>
</CurrentValue>
</Parameter>
<Parameter>
<Identifier>ref_x</Identifier>
<Name><![CDATA[X-Abmessung]]></Name>
<Group><![CDATA[]]></Group>
<Type>1</Type>
<Attribute>-1</Attribute>
<SystemID>1</SystemID>
<Expandable>0</Expandable>
<Hidden>0</Hidden>
<Lock>0</Lock>
<Export>0</Export>
<Save>1</Save>
<CurrentValue>
<Value>
<Type>6</Type>
<StringValue/>
<DoubleValue>1.000000000000</DoubleValue>
</Value>
</CurrentValue>
</Parameter>
<Parameter>
<Identifier>ref_y</Identifier>
<Name><![CDATA[Y-Abmessung]]></Name>
<Group><![CDATA[]]></Group>
<Type>1</Type>
<Attribute>-1</Attribute>
<SystemID>2</SystemID>
<Expandable>0</Expandable>
<Hidden>0</Hidden>
<Lock>0</Lock>
<Export>0</Export>
<Save>1</Save>
<CurrentValue>
<Value>
<Type>6</Type>
<StringValue/>
<DoubleValue>1.000000000000</DoubleValue>
</Value>
</CurrentValue>
</Parameter>
<Parameter>
<Identifier>ref_z</Identifier>
<Name><![CDATA[räumliche Texthöhe]]></Name>
<Group><![CDATA[]]></Group>
<Type>1</Type>
<Attribute>-1</Attribute>
<SystemID>3</SystemID>
<Expandable>0</Expandable>
<Hidden>0</Hidden>
<Lock>0</Lock>
<Export>0</Export>
<Save>1</Save>
<CurrentValue>
<Value>
<Type>6</Type>
<StringValue/>
<DoubleValue>0.100000000000</DoubleValue>
</Value>
</CurrentValue>
</Parameter>
<Parameter>
<Identifier>text_color</Identifier>
<Name><![CDATA[Textfarbe]]></Name>
<Group><![CDATA[]]></Group>
<Type>7</Type>
<Attribute>-1</Attribute>
<SystemID>0</SystemID>
<Expandable>0</Expandable>
<Hidden>0</Hidden>
<Lock>0</Lock>
<Export>0</Export>
<Save>1</Save>
<CurrentValue>
<Value>
<Type>6</Type>
<StringValue/>
<DoubleValue>7.000000000000</DoubleValue>
</Value>
</CurrentValue>
</Parameter>
<Parameter>
<Identifier>text_size</Identifier>
<Name><![CDATA[Zeichenhöhe]]></Name>
<Group><![CDATA[]]></Group>
<Type>1</Type>
<Attribute>-1</Attribute>
<SystemID>0</SystemID>
<Expandable>0</Expandable>
<Hidden>0</Hidden>
<Lock>0</Lock>
<Export>0</Export>
<Save>1</Save>
<CurrentValue>
<Value>
<Type>6</Type>
<StringValue/>
<DoubleValue>500.0000000000</DoubleValue>
</Value>
</CurrentValue>
</Parameter>
<Parameter>
<Identifier>x_char_rotation</Identifier>
<Name><![CDATA[Rotation X-Achse]]></Name>
<Group><![CDATA[]]></Group>
<Type>2</Type>
<Attribute>-1</Attribute>
<SystemID>0</SystemID>
<Expandable>0</Expandable>
<Hidden>0</Hidden>
<Lock>0</Lock>
<Export>0</Export>
<Save>1</Save>
<CurrentValue>
<Value>
<Type>6</Type>
<StringValue/>
<DoubleValue>0.000000000000</DoubleValue>
</Value>
</CurrentValue>
</Parameter>
<Parameter>
<Identifier>y_char_rotation</Identifier>
<Name><![CDATA[Rotation Y-Achse]]></Name>
<Group><![CDATA[]]></Group>
<Type>2</Type>
<Attribute>-1</Attribute>
<SystemID>0</SystemID>
<Expandable>0</Expandable>
<Hidden>0</Hidden>
<Lock>0</Lock>
<Export>0</Export>
<Save>1</Save>
<CurrentValue>
<Value>
<Type>6</Type>
<StringValue/>
<DoubleValue>0.000000000000</DoubleValue>
</Value>
</CurrentValue>
</Parameter>
<Parameter>
<Identifier>z_char_rotation</Identifier>
<Name><![CDATA[Rotation Z-Achse]]></Name>
<Group><![CDATA[]]></Group>
<Type>2</Type>
<Attribute>-1</Attribute>
<SystemID>0</SystemID>
<Expandable>0</Expandable>
<Hidden>0</Hidden>
<Lock>0</Lock>
<Export>0</Export>
<Save>1</Save>
<CurrentValue>
<Value>
<Type>6</Type>
<StringValue/>
<DoubleValue>0.000000000000</DoubleValue>
</Value>
</CurrentValue>
</Parameter>
</Parameters>
<Script><PartParameter>
<Enable>1</Enable>
<Text><![CDATA[! Curved3DText
! (c) 2012, Manfred Moitzi, smartparts.tzb-moitzi.at
! License: GPLv3, www.fsf.org

VALUES "text_size" RANGE (0, ] 
VALUES "ref_z" RANGE (0, ]]]></Text>
</PartParameter>
<PartMaster>
<Enable>0</Enable>
<Text><![CDATA[]]></Text>
</PartMaster>
<Part2D>
<Enable>0</Enable>
<Text><![CDATA[
]]></Text>
</Part2D>
<Part3D>
<Enable>1</Enable>
<Text><![CDATA[! CurvedText
! (c) 2012, Manfred Moitzi, smartparts.tzb-moitzi.at
! License: GPLv3, www.fsf.org

! Array bezier_points defines the top wave
! bezier_points[n][i] ... n=point number, i=axis (1=x-axis, 2=y-axis)
! global bezier curve definition points





axis_count = 2

DIM result[axis_count] ! global result array
DIM bezier_factor[4] ! temp var for bezier point calculation

DEFINE STYLE "T1" font_name, text_size, 8, 1
SET STYLE "T1"
COLOR text_color

! calculate real text height in meters
! text_size in mm 

real_text_height = text_size / 1000


length_of_text = STW(curved_text)
pos = (STW('A') / 2)

GOSUB "str2array"
! result: array chars[] contains characters of string "curved_text"

FOR i = 1 TO VARDIM1(chars)
	! bezier parameter t = RANGE [0, 1]
	t = pos / length_of_text 
    ! get point on bezier curve at position 't'
	bezier_factor[1] = (1.0 - t)^3
	bezier_factor[2] = 3.0 * (1.0 - t)^2 * t
	bezier_factor[3] = 3.0 * (1.0 - t) * t^2
	bezier_factor[4] = t^3
	GOSUB "bezier_calc"
	x = result[1]
	y = result[2]
	! get tangent on bezier curve at position 't'
	bezier_factor[1] = -3.0 * (1.0 - t)^2
	bezier_factor[2] =  3.0 * (1.0 - 4.0 * t + 3.0 * t^2)
	bezier_factor[3] =  3.0 * t * (2.0 - 3.0 * t)
	bezier_factor[4] =  3.0 * t^2
	GOSUB "bezier_calc"
	vx = result[1]
	vy = result[2]
	GOSUB "vector_to_angle" 
	! result: alpha = angle of curve tangent
	IF i = 1 THEN ! store direction perpendicular to tangent of first character
		size_handle_vx = -vy
		size_handle_vy = vx
	ENDIF
	! place character at x,y with rotation alpha
	
TRANS x, y, 0
ROTZ alpha
IF PREV_MODE THEN
	IF chars[i] <> " " THEN
		TRANSX -real_text_height/2
		ROTX x_char_rotation
		ROTY y_char_rotation
		ROTZ z_char_rotation
		SCALEX char_width_factor
		BOX real_text_height, real_text_height, ref_z
		RESTORE 5
	ENDIF
ELSE
	IF chars[i] <> " " THEN
		ROTX x_char_rotation
		ROTY y_char_rotation
		ROTZ z_char_rotation
		SCALEX char_width_factor
		TEXT ref_z, 0, chars[i]
		RESTORE 4
	ENDIF
ENDIF
RESTORE 2

	pos = pos + STW(chars[i])
NEXT i


! place handle for bezier point (1)
HANDLE (bezier_points[1][1]), (0), (0), 1, bezier_points[1][2], 1
HANDLE (bezier_points[1][1]), (bezier_points[1][2]), (0), 1, bezier_points[1][2], 2
HANDLE (bezier_points[1][1]), (-1), (0), 1, bezier_points[1][2], 3
HANDLE (0), (bezier_points[1][2]), (0), 1, bezier_points[1][1], 1
HANDLE (bezier_points[1][1]), (bezier_points[1][2]), (0), 1, bezier_points[1][1], 2
HANDLE (-1), (bezier_points[1][2]), (0), 1, bezier_points[1][1], 3

! place handle for bezier point (2)
HANDLE (bezier_points[2][1]), (0), (0), 2, bezier_points[2][2], 1
HANDLE (bezier_points[2][1]), (bezier_points[2][2]), (0), 2, bezier_points[2][2], 2
HANDLE (bezier_points[2][1]), (-1), (0), 2, bezier_points[2][2], 3
HANDLE (0), (bezier_points[2][2]), (0), 2, bezier_points[2][1], 1
HANDLE (bezier_points[2][1]), (bezier_points[2][2]), (0), 2, bezier_points[2][1], 2
HANDLE (-1), (bezier_points[2][2]), (0), 2, bezier_points[2][1], 3

! place handle for bezier point (3)
HANDLE (bezier_points[3][1]), (0), (0), 3, bezier_points[3][2], 1
HANDLE (bezier_points[3][1]), (bezier_points[3][2]), (0), 3, bezier_points[3][2], 2
HANDLE (bezier_points[3][1]), (-1), (0), 3, bezier_points[3][2], 3
HANDLE (0), (bezier_points[3][2]), (0), 3, bezier_points[3][1], 1
HANDLE (bezier_points[3][1]), (bezier_points[3][2]), (0), 3, bezier_points[3][1], 2
HANDLE (-1), (bezier_points[3][2]), (0), 3, bezier_points[3][1], 3

! place handle for bezier point (4)
HANDLE (bezier_points[4][1]), (0), (0), 4, bezier_points[4][2], 1
HANDLE (bezier_points[4][1]), (bezier_points[4][2]), (0), 4, bezier_points[4][2], 2
HANDLE (bezier_points[4][1]), (-1), (0), 4, bezier_points[4][2], 3
HANDLE (0), (bezier_points[4][2]), (0), 4, bezier_points[4][1], 1
HANDLE (bezier_points[4][1]), (bezier_points[4][2]), (0), 4, bezier_points[4][1], 2
HANDLE (-1), (bezier_points[4][2]), (0), 4, bezier_points[4][1], 3


! place text size handle
x = bezier_points[1][1]
y = bezier_points[1][2]

! normalize direction vector
size_handle_length = SQR(size_handle_vx^2 + size_handle_vy^2)
vx = size_handle_vx / size_handle_length
vy = size_handle_vy / size_handle_length

dx = vx * real_text_height
dy = vy * real_text_height

! calibrate handle
HANDLEFACTOR text_size/real_text_height


! place text size handle
!HANDLE (x), (y), (0), 5, text_size, 1
!HANDLE (x+dx), (y+dy), (0), 5, text_size, 2
!HANDLE (x-dx), (y-dy), (0), 5, text_size, 3

! reset handle factor
HANDLEFACTOR 1

! place text heigth handle
!HANDLE (x), (y), (0), 6, ref_z, 1
!HANDLE (x), (y), (ref_z), 6, ref_z, 2
!HANDLE (x), (y), (-1), 6, ref_z, 3


END

!--------------------------------------------------------------
"str2Array":
DIM chars[STRLEN(curved_text)]
FOR __i__ = 1 TO STRLEN(curved_text)
	chars[__i__] = STRSUB(curved_text, __i__, 1)
NEXT __i__
RETURN

"vector_to_angle":
IF vx <> 0 THEN
	alpha = ATAN(vy/vx)
	IF vx < 0 THEN
		alpha = alpha + 180
	ENDIF
ELSE
	IF vy > 0 THEN
		alpha = 90
	ELSE
		alpha = -90
	ENDIF
ENDIF
RETURN

"bezier_calc":
FOR __i__ = 1 to axis_count
    result[__i__] = 0.0
NEXT __i__

FOR __i__ = 1 TO 4
    FOR __axis__ = 1 to axis_count
        result[__axis__] = result[__axis__] + bezier_points[__i__][__axis__] * bezier_factor[__i__]
    NEXT __axis__
NEXT __i__
RETURN
!--------------------------------------------------------------








]]></Text>
</Part3D>
<PartDialog>
<Enable>1</Enable>
<Text><![CDATA[! Curved3DText
! (c) 2012, Manfred Moitzi, smartparts.tzb-moitzi.at
! License: GPLv3, www.fsf.org

I_PALETTE `CurvedText`, 1,
"(c) 2012 Manfred Moitzi", "link=http://smartparts.tzb-moitzi.at TZBM",
"General Public License v3 (GPLv3)", "link=http://www.gnu.org/licenses/ Lizenz"

I_SECTION `Eigenschaften`
I_INFIELD "curved_text", 0, 0, 1, 1
I_INFIELD "text_color", 0, 0, 1, 1
I_INFIELD "text_size", 0, 0, 1, 1 I_TOOLTIP `in [mm] unabhängig vom Maßstab`
I_INFIELD "char_width_factor", 0, 0, 1, 1 I_TOOLTIP `Verhältnis Zeichenbreite/Zeichenhöhe
Faktor 2 = 2x so breit wie hoch`
I_INFIELD "font_name", 0, 0, 1, 1
I_SECTION_END

I_SECTION `3D Parameter`
I_INFIELD "ref_z", 0, 0, 1, 1
I_INFIELD "x_char_rotation", 0, 0, 1, 1
I_INFIELD "y_char_rotation", 0, 0, 1, 1
I_INFIELD "z_char_rotation", 0, 0, 1, 1
I_SECTION_END]]></Text>
</PartDialog>
</Script>
<Drawing2D>
</Drawing2D>
<Drawing3D>
</Drawing3D>
<Pictures>
<ImportBitmaps>0</ImportBitmaps>
<ManageInList>1</ManageInList>
<Picture Name="0" Type="png" Width="146" Height="159"><![CDATA[89504E470D0A1A0A0000000D49484452000000920000009F080600000012E58050000000017352474200AECE1CE90000000467414D410000B18F0BFC6105000000097048597300000EC300000EC301C76FA8640000054D49444154785EED9B8B6EE3300C04FBFF3F7D2F3480CFB5252A59ADADF51438E0D038A4389C52B2D37EFDE20B0202025F82188480C02F4442020901449260240822E1808400224930120491704042009124180982483820218048128C0441241C9010402409468220120E480820920423411009072404104982912088840312028824C1481044C2010901449260240822E1808400224930120491704042009124180982483820218048128C0441241C9010402409468220120E480820920423411009072404104982912088840312028824C1481044C2010901449260240822E1808400224930120491704042009124180982483820218048128C0441241C9010402409468220120E480820920423411009072404104982912088840312028824C1481044C2010901449260240822E1808400224930120491704042009124180982483820218048128CF70BF2F5A7B3FB7F3357894833E94E8AFD12E46FF8BFFF3FFA42A449F0570BBB9565BFF6CAA441A4D53A3E61BD5B09CEA6CD6B1A31912634609590BDAD099156E9A4699D675B506FDB4124538356487324CB6B1B6ABDB6DDB25ADB165BDB0A1608D68848028884F8F90C677F2E6A6D6FA35BDB7E72F526DE8CFEF01C6906D5EFE73B67B2F41ADD12A9F7DEFDD6587954A040804883147BD3E2154EB5B555A6CDD183C98A7083A5372F47A4419A33456A4DB0ED322B9254D73958FEE9E5883448B2BA55BC3B915A777667D36EB0842997235203EB990C959FF6CA7B2BCF99A6747D425044328B74D56178823BFF8544A46F1CDBDBF3DE81F96822556EEFB707E7EA16395B00557C44DA895415E24884EA7B55CDBB539CC78BB43FDCF6B69ED6D9673BC98EE2DCA9F1EAB53C56A4FDF6549D2623876875B3EE1CEF9122F5A6CA882C4713EDCE0D9FB5B6C7885495A3B7B59DBD3EAB41ABC445A4DD2FC9F7444ABBDB52891A2952EB8EAA3A997AD7A91A9012274EA49E009FBE9ED278751D8874F0F75F6C5FE39A215243A4719CCF7D07229D88F45C25DEAB7C5991CE3E81E70CF49E089FBE2B4224C553E94F413EFDFD88B42C817BA9BB2CC6A32D8C8789D7C9755B917ABF85F8A948D721CFCC7C4B912ACF71DE3D5467B6F1FAAA2E17A9FA71C61ED59948ADEDED7ADCB92BB89D482D41B66D189948B9EDBB4F65CB895415E83E889FB112B948BD4372758BAA6E7995F3D4335A796D956F8B5479B25C29AD3A61AAD75572728D9EC0A948AD9FF4775F3B5A7E5590DE757A34441C212011E9F57BCB47774CBDC5F404E9BDDE8BCFEB1E024B8AE44143961102978AD49B361CA4475A79EDB5569146C519BD03BC16E5B3B34F17692FC3EB3C5591EAD9AD59ABFAE9221D1DC05B12AD858FD5BE080C8B549924AD4FE6CFC4A2256B13F82152EFB3AEDE87A59509B43632567FF83C70FFCDB333CCF6BA9E4C1C929F27DBE1D6F6C9547A1E422AFEB70B1D8E29FE44073B0609BCFDA1ED601E2E0F278048E10D769587482ED2E1791029BCC1AEF210C9453A3C0F228537D8551E22B94887E741A4F006BBCA432417E9F03C8814DE60577988E4221D9E0791C21BEC2A0F915CA4C3F3205278835DE521928B74781E440A6FB0AB3C4472910ECF8348E10D769587482ED2E1791029BCC1AEF210C9453A3C0F228537D8551E22B94887E741A4F006BBCA432417E9F03C8814DE60577988E4221D9E0791C21BEC2A0F915CA4C3F3205278835DE521928B74781E440A6FB0AB3C4472910ECF8348E10D769587482ED2E1791029BCC1AEF210C9453A3C0F228537D8551E22B94887E741A4F006BBCA432417E9F03C8814DE60577988E4221D9E0791C21BEC2A0F915CA4C3F3205278835DE521928B74781E440A6FB0AB3C4472910ECF8348E10D769587482ED2E1791029BCC1AEF27E03E403382ACB14764F0000000049454E44AE426082]]></Picture>
</Pictures>
</ScriptObject>